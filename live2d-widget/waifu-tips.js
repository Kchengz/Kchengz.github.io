function loadWidget(t,o){localStorage.removeItem("waifu-display"),sessionStorage.removeItem("waifu-text"),$("body").append('<div id="waifu">\n\t\t\t<div id="waifu-tips"></div>\n\t\t\t<canvas id="live2d" width="300" height="300"></canvas>\n\t\t\t<div id="waifu-tool">\n\t\t\t\t<span class="fa fa-lg fa-comment"></span>\n\t\t\t\t<span class="fa fa-lg fa-paper-plane"></span>\n\t\t\t\t<span class="fa fa-lg fa-user-circle"></span>\n\t\t\t\t<span class="fa fa-lg fa-street-view"></span>\n\t\t\t\t<span class="fa fa-lg fa-camera-retro"></span>\n\t\t\t\t<span class="fa fa-lg fa-info-circle"></span>\n\t\t\t\t<span class="fa fa-lg fa-times"></span>\n\t\t\t</div>\n\t\t</div>'),$("#waifu").show().animate({bottom:0},3e3),$("#waifu-tool .fa-comment").click(c),$("#waifu-tool .fa-paper-plane").click(()=>{window.Asteroids?(window.ASTEROIDSPLAYERS||(window.ASTEROIDSPLAYERS=[]),window.ASTEROIDSPLAYERS.push(new Asteroids)):$.ajax({url:"https://cdn.jsdelivr.net/gh/GalaxyMimi/CDN/asteroids.js",dataType:"script",cache:!0})}),$("#waifu-tool .fa-user-circle").click(m),$("#waifu-tool .fa-street-view").click(d),$("#waifu-tool .fa-camera-retro").click(()=>{r("照好了嘛，是不是很可爱呢？",6e3,9),Live2D.captureName="photo.png",Live2D.captureFrame=!0}),$("#waifu-tool .fa-info-circle").click(()=>{open("https://github.com/stevenjoezhang/live2d-widget")}),$("#waifu-tool .fa-times").click(()=>{localStorage.setItem("waifu-display",(new Date).getTime()),r("愿你有一天能与重要的人重逢。",2e3,11),$("#waifu").animate({bottom:-500},3e3,()=>{$("#waifu").hide(),$("#waifu-toggle").show().animate({"margin-left":-50},1e3)})}),a=/x/,console.log(a),a.toString=()=>(r("哈哈，你打开了控制台，是想要看看我的小秘密吗？",6e3,9),""),$(document).on("copy",()=>{r("你都复制了些什么呀，转载要记得加上出处哦！",6e3,9)}),$(document).on("visibilitychange",()=>{document.hidden||r("哇，你终于回来了～",6e3,9)}),a=location.port?location.protocol+`//${location.hostname}:${location.port}/`:location.protocol+`//${location.hostname}/`,r(location.href==a?5<(a=(new Date).getHours())&&a<=7?"早上好！一日之计在于晨，美好的一天就要开始了。":7<a&&a<=11?"上午好！工作顺利嘛，不要久坐，多起来走动走动哦！":11<a&&a<=14?"中午了，工作了一个上午，现在是午餐时间！":14<a&&a<=17?"午后很容易犯困呢，今天的运动目标完成了吗？":17<a&&a<=19?"傍晚了！窗外夕阳的景色很美丽呢，最美不过夕阳红～":19<a&&a<=21?"晚上好，今天过得怎么样？":21<a&&a<=23?["已经这么晚了呀，早点休息吧，晚安～","深夜时要爱护眼睛呀！"]:"你是夜猫子呀？这么晚还不睡觉，明天起的来嘛？":""===document.referrer||((a=document.createElement("a")).href=document.referrer,e=a.hostname.split(".")[1],location.hostname==a.hostname)?`欢迎阅读<span style="color:#0099cc;">『${document.title.split(" - ")[0]}』</span>`:"baidu"==e?`Hello！来自 百度搜索 的朋友<br>你是搜索 <span style="color:#0099cc;">${a.search.split("&wd=")[1].split("&")[0]}</span> 找到的我吗？`:"so"==e?`Hello！来自 360搜索 的朋友<br>你是搜索 <span style="color:#0099cc;">${a.search.split("&q=")[1].split("&")[0]}</span> 找到的我吗？`:"google"==e?`Hello！来自 谷歌搜索 的朋友<br>欢迎阅读<span style="color:#0099cc;">『${document.title.split(" - ")[0]}』</span>`:`Hello！来自 <span style="color:#0099cc;">${a.hostname}</span> 的朋友`,7e3,8);var e,a,i=!1,l=null,n=null,s=["好久不见，日子过得好快呢……","大坏蛋！你都多久没理人家了呀，嘤嘤嘤～","嗨～快来逗我玩吧！","拿小拳拳锤你胸口！"];function c(){Math.random()<.6&&0<s.length?r(s[Math.floor(Math.random()*s.length)],6e3,9):$.getJSON("https://v1.hitokoto.cn",function(t){var e=`这句一言来自 <span style="color:#0099cc;">『${t.from}』</span>，是 <span style="color:#0099cc;">${t.creator}</span> 在 hitokoto.cn 投稿的。`;r(t.hitokoto,6e3,9),setTimeout(()=>{r(e,4e3,9)},6e3)})}function r(t,e,a){t&&(!sessionStorage.getItem("waifu-text")||sessionStorage.getItem("waifu-text")<=a)&&(n&&(clearTimeout(n),n=null),Array.isArray(t)&&(t=t[Math.floor(Math.random()*t.length)]),sessionStorage.setItem("waifu-text",a),$("#waifu-tips").stop().html(t).fadeTo(200,1),n=setTimeout(()=>{sessionStorage.removeItem("waifu-text"),$("#waifu-tips").fadeTo(1e3,0)},e))}function f(t,e){localStorage.setItem("modelId",t),void 0===e&&(e=0),localStorage.setItem("modelTexturesId",e),loadlive2d("live2d",o+`/get/?id=${t}-`+e,console.log(`Live2D 模型 ${t}-${e} 加载完成`))}function d(){var e=localStorage.getItem("modelId"),a=localStorage.getItem("modelTexturesId");$.ajax({cache:!1,url:o+`/rand_textures/?id=${e}-`+a,dataType:"json",success:function(t){1!=t.textures.id||1!=a&&0!=a?r("我的新衣服好看嘛？",4e3,10):r("我还没有其他衣服呢！",4e3,10),f(e,t.textures.id)}})}function m(){var t=localStorage.getItem("modelId");$.ajax({cache:!1,url:o+"/switch/?id="+t,dataType:"json",success:function(t){f(t.model.id),r(t.model.message,4e3,10)}})}$(".fa-share-alt").is(":hidden")&&s.push("记得把小家加入 Adblock 白名单哦！"),$(document).mousemove(()=>{i=!0}).keydown(()=>{i=!0}),setInterval(()=>{l=i?(i=!1,clearInterval(l),null):l||setInterval(c,25e3)},1e3),e=localStorage.getItem("modelId"),a=localStorage.getItem("modelTexturesId"),null==e&&(e=1,a=53),f(e,a),$.getJSON(t,function(t){$.each(t.mouseover,function(t,e){$(document).on("mouseover",e.selector,function(){r((Array.isArray(e.text)?e.text[Math.floor(Math.random()*e.text.length)]:e.text).replace("{text}",$(this).text()),4e3,8)})}),$.each(t.click,function(t,e){$(document).on("click",e.selector,function(){r((Array.isArray(e.text)?e.text[Math.floor(Math.random()*e.text.length)]:e.text).replace("{text}",$(this).text()),4e3,8)})}),$.each(t.seasons,function(t,e){var a=new Date,o=e.date.split("-")[0],i=e.date.split("-")[1]||o;o.split("/")[0]<=a.getMonth()+1&&a.getMonth()+1<=i.split("/")[0]&&o.split("/")[1]<=a.getDate()&&a.getDate()<=i.split("/")[1]&&(o=(o=Array.isArray(e.text)?e.text[Math.floor(Math.random()*e.text.length)]:e.text).replace("{year}",a.getFullYear()),s.push(o))})})}function initWidget(t="/waifu-tips.json",e=""){screen.width<=768||($("body").append('<div id="waifu-toggle" style="margin-left: -100px;">\n\t\t\t<span>看板娘</span>\n\t\t</div>'),$("#waifu-toggle").hover(()=>{$("#waifu-toggle").animate({"margin-left":-30},500)},()=>{$("#waifu-toggle").animate({"margin-left":-50},500)}).click(()=>{$("#waifu-toggle").animate({"margin-left":-100},1e3,()=>{$("#waifu-toggle").hide()}),$("#waifu-toggle").attr("first-time")?(loadWidget(t,e),$("#waifu-toggle").attr("first-time",!1)):(localStorage.removeItem("waifu-display"),$("#waifu").show().animate({bottom:0},3e3))}),localStorage.getItem("waifu-display")&&(new Date).getTime()-localStorage.getItem("waifu-display")<=864e5?$("#waifu-toggle").attr("first-time",!0).css({"margin-left":-50}):loadWidget(t,e))}